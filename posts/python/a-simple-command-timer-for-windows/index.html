<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Time how long a command takes under Windows command prompt">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>A Simple Command Timer for Windows | RC Notebook</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://ravi-chandran.github.io/posts/python/a-simple-command-timer-for-windows/">
<link rel="icon" href="../../../images/favicons/favicon.ico" sizes="48x48">
<link rel="icon" href="../../../images/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" href="../../../images/favicons/favicon-16x16.png" sizes="16x16">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Ravi Chandran">
<link rel="prev" href="../../unity/unity-ml-agents-installation-for-windows/" title="Unity ML Agents Installation for Windows" type="text/html">
<link rel="next" href="../../miscellaneous/wifi-router-with-raspberry-pi/" title="Developing With Equipment From Work During The Pandemic" type="text/html">
<meta property="og:site_name" content="RC Notebook">
<meta property="og:title" content="A Simple Command Timer for Windows">
<meta property="og:url" content="https://ravi-chandran.github.io/posts/python/a-simple-command-timer-for-windows/">
<meta property="og:description" content="Time how long a command takes under Windows command prompt">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-03-08T14:02:48-04:00">
<meta property="article:tag" content="PyPI">
<meta property="article:tag" content="pytest">
<meta property="article:tag" content="python">
<meta property="article:tag" content="terminalizer">
<meta property="article:tag" content="Travis CI">
<meta property="article:tag" content="twine">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="../../../">
            <img src="../../../images/rcnotebooksmall.png" alt="RC Notebook" id="logo" class="d-inline-block align-top"></a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav">
<li class="nav-item">
    <a href="index.md" id="sourcelink" class="nav-link">Source</a>
    </li>


                    
            </ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="../../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../../rss.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">A Simple Command Timer for Windows</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Ravi Chandran
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2020-03-08T14:02:48-04:00" itemprop="datePublished" title="2020-03-08">2020-03-08</time></a>
            </p>
                <p class="commentline">
        
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/python/a-simple-command-timer-for-windows.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="index.md" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p><img alt="" src="../../../images/python/cmdtimedemo.gif"></p>
<p>It's amazing how a trivial search for something that should obviously exist spirals out of control...</p>
<p>It all started with this. I was tinkering with some Python machine learning scripts which took a while to run, and wanted to know how long they took to run. Unfortunately, I was running my scripts on a Windows command prompt so that Tensorflow could access my PC's NVIDIA GPU. Under Linux via VirtualBox, GPU access doesn't work. Hence my need to use Windows (or get another native Linux machine...)</p>
<p>Under Linux, there's the well known <code>time</code> utility that can tell you how long a command took to run. However, I was surprised to find no equivalent utility available in the Windows 10 command prompt. Yes, there are a myriad of solutions for this: use PowerShell, or install Cygwin, or install Bash for Linux, or install one of several old binaries that provide the solution that used to exist on some long-forgotten Windows version. I'm wary of installing anything, especially old binaries of dubious origin. Of course, there's also the more cumbersome approach of simply adding the timing functionality into the Python scripts themselves. It'd be just a few lines of code.</p>
<p>Hey, why not just create a Python console script that does something like what the Linux <code>time</code> utility does? It'd only be a few lines of code, right? And so, that's how this little detour started...</p>
<!-- TEASER_END -->

<h3>Let's <code>twine</code> It To PyPI</h3>
<p>I've called this little utility <code>cmdtime</code>. It's based on a tiny Python <a href="https://github.com/ravi-chandran/cmdtime/blob/master/cmdtime/cmdtime.py">script</a> that's only about a dozen lines long. Once <code>pip</code> installed, you can time a Python script or any other terminal command by just prefixing the command with <code>cmdtime</code>. I decided to make it open source via <a href="https://github.com/ravi-chandran/cmdtime">GitHub</a> and available via <a href="https://pypi.org/project/cmdtime/">PyPI</a>. Actually, I checked on PyPI first to make sure the name <code>cmdtime</code> wasn't already taken. And also made sure there were no other older utilities on Windows with the same name to avoid confusion. In addition, I tried it out on <a href="https://test.pypi.org/">TestPyPI</a> first before <a href="https://github.com/pypa/twine"><code>twine</code></a>-ing it to its final resting place at <a href="https://pypi.org/project/cmdtime/">PyPI</a>.</p>
<h3>Let's <code>pytest</code> It</h3>
<p>Okay, now that I have that, wouldn't it be nice to add unit tests just as an exercise?</p>
<p>So I did that with <a href="https://github.com/pytest-dev/pytest"><code>pytest</code></a>. There was a little bit of research to figure out how best to test a console application. I settled on using Python <code>subprocess.run()</code> to do it. The resulting <a href="https://github.com/ravi-chandran/cmdtime/blob/master/tests/test_cmdtime.py">test script</a> is quite simple.</p>
<h3>Let's Test Multiple Python Versions With Travis CI</h3>
<p>The next question was: Wouldn't it be nice if this was automatically tested under multiple Python versions via <a href="https://travis-ci.org/">Travis CI</a>?</p>
<p>So I ventured into that and noticed that Travis CI only supported Python under Linux at present. Although Windows testing is what would make sense for this application, I added the tests under Linux anyway. This almost doubled the number of unit tests. Each test had to be crafted specifically for the given OS as the syntax of the terminal commands that I timed were slightly different between Windows and Linux.</p>
<p>In the interest of time (no pun intended), I gave up on further adapting the tests for Python versions below 3.7 as the <code>subprocess.run()</code> functionality had changed enough between 3.5, 3.6 and 3.7 to make it painful.</p>
<h3>What About Python Testing Under Windows With Travis CI?</h3>
<p><code>cmdtime</code> is meant for Windows users. So it would have been a tragedy indeed if the unit tests were only possible under Linux. Luckily, I found <a href="https://gist.github.com/shaypal5/7fd766933fb265af6f71a88cb91dd08c">this</a> which explained how Travis CI could be used to test Python under Windows. One simply had to use <a href="https://chocolatey.org/">Chocolatey</a> to install Python on the Windows VMs.</p>
<p>With the necessary updates to the <a href="https://github.com/ravi-chandran/cmdtime/blob/master/.travis.yaml">Travis CI configuration file</a>, I finally attained the  glorious 100% tests passing state across both Windows and Linux for multiple Python versions, albeit for a trivial application. And never mind that no one's going to use this little utility under Linux... (And at least one known user for Windows...)</p>
<h3>How About Those Flashy GIFs For The README?</h3>
<p>After coming this far, you can't just stop there. Wouldn't it be nice to add in a dynamic GIF to the <code>README</code> that provides a little demo of what this does? </p>
<p><a href="https://intoli.com/blog/terminal-recorders/">Lots of tools are available</a> to do this but almost all for Linux. And nothing Python-based that did what I wanted. Eventually, I settled on <a href="https://terminalizer.com/">Terminalizer</a> which seemed to be actively maintained and did it's job under Windows well.</p>
<p>I had to experiment with the settings to change the default which used PowerShell for recording. I got it to launch the Windows command prompt instead. Also had to tinker with the settings to get rid of the Mac look which would've been a really weird way to showcase this Windows-focused utility. My only real gripe about Terminalizer is that it automatically assumes you want to upload the recording and I had to break out of that every time. I didn't find an option to disable this annoyance. It's use of YAML for the recording is a great idea and allowed me to adjust the delays between events in the recording. The result was the snappy little demo GIF at the beginning of this blog.</p>
<h3>Finishing Touches</h3>
<p>Add in the cool "build passing" badge from Travis CI <a href="https://travis-ci.org/ravi-chandran/cmdtime"><img alt="Build Status" src="https://travis-ci.org/ravi-chandran/cmdtime.svg?branch=master"></a> and hope that it continues to pass...</p>
<p>Only one lonely badge? To keep it company, let's add in the MIT License badge:
<a href="https://opensource.org/licenses/MIT"><img alt="License: MIT" src="https://img.shields.io/badge/License-MIT-yellow.svg"></a></p>
<p>Okay, I'm done now. I promise.</p>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../categories/pypi/" rel="tag">PyPI</a></li>
            <li><a class="tag p-category" href="../../../categories/pytest/" rel="tag">pytest</a></li>
            <li><a class="tag p-category" href="../../../categories/python/" rel="tag">python</a></li>
            <li><a class="tag p-category" href="../../../categories/terminalizer/" rel="tag">terminalizer</a></li>
            <li><a class="tag p-category" href="../../../categories/travis-ci/" rel="tag">Travis CI</a></li>
            <li><a class="tag p-category" href="../../../categories/twine/" rel="tag">twine</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../../unity/unity-ml-agents-installation-for-windows/" rel="prev" title="Unity ML Agents Installation for Windows">Previous post</a>
            </li>
            <li class="next">
                <a href="../../miscellaneous/wifi-router-with-raspberry-pi/" rel="next" title="Developing With Equipment From Work During The Pandemic">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="rcnotebook",
            disqus_url="https://ravi-chandran.github.io/posts/python/a-simple-command-timer-for-windows/",
        disqus_title="A Simple Command Timer for Windows",
        disqus_identifier="cache/posts/python/a-simple-command-timer-for-windows.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="rcnotebook";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer">
            Contents Â© 2021         <a href="mailto:">Ravi Chandran</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<br><a rel="license" href="https://opensource.org/licenses/MIT">MIT License for Software, </a>
<a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons License CC BY 4.0 for other items</a>

            
            
        </footer>
</div>
</div>


        <script src="../../../assets/js/all-nocdn.js"></script><script src="https://polyfill.io/v3/polyfill.js?features=Intl.RelativeTimeFormat.%7Elocale.en"></script><script src="../../../assets/js/luxon.min.js"></script><!-- fancy dates --><script>
        luxon.Settings.defaultLocale = "en";
        fancydates(2, {"preset": false, "format": "yyyy-MM-dd HH:mm"});
        </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
